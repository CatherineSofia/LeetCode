#!/usr/bin/python
# ==============================================================================
# Author:   Tao Li (taoli@ucsd.edu)
# Date:     Jun 3, 2015
# Question: 221-Maximal-Square
# Link:     https://leetcode.com/problems/maximal-square/
# ==============================================================================
# Given a 2D binary matrix filled with 0's and 1's, find the largest square containing all 1's and return its area.
# 
# For example, given the following matrix:
# 
# 1 0 1 0 0
# 1 0 1 1 1
# 1 1 1 1 1
# 1 0 0 1 0
# 
# Return 4.
# ==============================================================================
# Method: Naive Method
# Time Complexity: O(n^2)
# Space Complexity: O(1)
# ==============================================================================

class Solution:
    # @param {character[][]} matrix
    # @return {integer}
    def maximalSquare(self, matrix):
        if not matrix or not matrix[0]:
            return 0
        
        m, n = len(matrix), len(matrix[0])
        i = j = 0
        maxVal = 0

        while i < m and j < n:
            k = 0
            while i+k<m and j+k<n and '0' not in matrix[i+k][j:j+k+1] and '0' not in [matrix[l][j+k] for l in xrange(i,i+k+1)]:
                k += 1
                
            maxVal = max(maxVal, k)
            i += (j+1) >= n
            j = (j+1)%n

        return maxVal**2

if __name__ == '__main__':
    # matrix = [['0','0','1'], ['1','0','1'], ['1','1','1']]
    # matrix = [['0']]
    # matrix = ["1"]
    # matrix = ["000","000","111"]
    # matrix = ["00", "01"]
    # matrix = ["11", "11"]
    # matrix = ["1010","1011","1011","1111"]
    matrix = ["11111111","11111110","11111110","11111000","01111000"]
    # matrix = ["1111111111111101001111111100111011111111","1111011011111111101101111101111111111111","0111101011111101101101101111111111111111","0101101011111111111101111111010110111111","1111111111110111110110010111111111111111","1111111110110101111111111101011111101111","0110110101110011111111111111110111110101","0111111111111100111111100110011011010101","1111011110111111111011011011110101101011","1111111110111111111101101101110111101111","1110110011111111111100111111111111111111","1011111110111101111001110111111111111111","0110111111111111101111110111011111011111","1111111111111111011111111111110111111011","1111100111111110101100111111111111101111","1111101111111110111111011111111111011111","1111101111111111111111011001111110011111","1111110111111111011111111111110111110111","1011111111111111010111110010111110111111","1111110011111111111110111111111111111011","1111111111111111110111011111011111011011","1100011011111111111111011111011111111111","1111101011111111111101100101110011111111","1110010111111111111011011110111101111101","1111111111111101101111111111101111111111","1111111011111101111011111111111110111111","1110011111111110111011111111110111110111","1111111111111100111111010111111111110111","1111111111111111111111000111111111011101","1111110111111111111111111101100111011011","1111011011111101101101111110111111101111","1111111111011111111111111111111111111111","1111111111111111111111111111111111111111","1100011111111110111111111111101111111011","1111101111111101111010111111111111111111","0111111111110011111111110101011011111111","1011011111101111111111101111111111110011","1010111111111111111111111111111110011111","0111101111011111111111111111110111111111","0111111011111111011101111011101111111111","0111111111110101111011111101011001111011","1111111111111011110111111101111111101110","1111101111111100111111111110111111001111","1101101111110101111101111111100111010100","0110111111100111110010111110111011011101"]
    print "\n".join(matrix)
    print Solution().maximalSquare(matrix)